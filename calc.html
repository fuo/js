<html>
<head>
</head>
<body>
<input id='output' readonly/>
<br/>
<button id='one'>1</button>
<button id='two'>2</button>
<button id='three'>3</button>
<button id='add'>+</button>
<br/>
<button id='four'>4</button>
<button id='five'>5</button>
<button id='six'>6</button>
<button id='subtract'>-</button>
<br/>
<button id='seven'>7</button>
<button id='eight'>8</button>
<button id='nine'>9</button>
<button id='multiply'>*</button>
<br/>
<button id='zero'>0</button>
<button id='dot'>.</button>
<button id='equal'>=</button>
<button id='divide'>/</button>

<script >

class Calculator {
    
	constructor(output) {
    var calc_itself = this;

    calc_itself.outputHTML = output;

		calc_itself.state = {
	  	input: '',
      cachedInput: '',
		  accumulator: 0,      
      lastOperator: function(){
        var state = this;

      	state.accumulator = state.input;
      },
      dot: 0
	  };

  };
  
  pressNumeric(value) {
  	this.state.input = parseFloat(`${this.state.input}${value.match(/^[0-9]$/)}`);
    this.state.cachedInput = this.state.input;

    this.outputHTML.value = this.state.input;
  };

  pressDot() {
    this.state.input = this.state.dot * this.state.cachedInput || (this.state.input || 0) + ".";
    this.state.dot = 1;

    this.outputHTML.value = this.state.input;
  };

  pressMultiply() {
  	this.execute();
    this.state.lastOperator = function() {
    	this.accumulator = (this.accumulator || 0) * (this.input || 1);
    };
  };
  
  pressAdd() {
  	this.execute();
    this.state.lastOperator = function() {
    	this.accumulator = (this.accumulator || 0) + (this.input || 0);
    };
  };
  
  pressSubtract() {
  	this.execute();
    this.state.lastOperator = function() {
    	this.accumulator = (this.accumulator || 0) - (this.input || 0);
    };
  };
  
  pressDivide() {
  	this.execute();
    this.state.lastOperator = function() {
    	this.accumulator = (this.accumulator || 0) / (this.input || 1);
    };
  };
  
  pressEqual() {
  	this.execute();
    this.state.lastOperator = function() {
    	this.accumulator = this.cachedInput;
    };
  };
  
  onPress(id) {
    var func = 'press' + id.charAt(0).toUpperCase() + id.slice(1);
    this[func]();
  };

  execute() {
  	this.state.lastOperator();
    this.state.cachedInput = this.state.accumulator;
    this.state.input = '';
    this.state.dot = 0;

    this.outputHTML.value = this.state.cachedInput;
  };
  
	getState() { return this.state; };
  
}

const calc = new Calculator(document.getElementById('output'));

['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'zero'].forEach( id => document.getElementById(id)
  .addEventListener('click', event => {
    calc.pressNumeric(event.target.innerHTML);
  })
);

['divide', 'equal', 'multiply', 'add', 'subtract', 'dot'].forEach( id => document.getElementById(id)
  .addEventListener('click', () => calc.onPress(id))
);

</script>

</body>
</html>